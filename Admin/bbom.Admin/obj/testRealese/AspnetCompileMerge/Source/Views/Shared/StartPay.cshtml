@model bbom.Admin.Core.ViewModels.Pay.PayViewModel
@{
    ViewBag.Title1 = "Тарифные планы";
    ViewBag.Title2 = "Скидочные предложения";
}
@using (Html.BeginForm("StartPay", "Payment"))
{
    <div class="panel panel-primary" style="margin-top: 20px">
        <div class="panel-heading">@ViewBag.Title1</div>
        <div class="panel-body">
            <div class="form-group">
                @foreach (var paymentPlan in Model.PaymentPlans)
                {
                    <div class="panel panel-info">
                        @paymentPlan.Name<br/>
                        <strong>Цена</strong>
                        @(paymentPlan.Amount) руб.<br/>
                        <label class="btn btn-primary">
                            @Html.RadioButton("selectPlanId", paymentPlan.Id)Выбрать
                           @* <input type="radio" name="selectPlanId" id="@("option" + paymentPlan.Id)" data="@paymentPlan.Id" onclick="selectPlan(this)"> Выбрать*@
                        </label>
                    </div>
                }
            </div>
        </div>
    </div>
    <div id="panelDiscounts" class="panel panel-primary" style="margin-top: 20px">
        <div class="panel-heading">@ViewBag.Title2</div>
        <div class="panel-body">
            <div class="form-group">
                @foreach (var discount in Model.Discounts)
                {
                    <div class="panel panel-info">
                        @discount.Name<br/>
                        <strong>Скидка</strong>
                        @discount.DiscountAmount%<br/>
                        <label class="btn btn-primary">
                            @Html.RadioButton("selectDiscountId", discount.Id)Выбрать
                            @*<input type="radio" name="selectDiscountId" id="@("option" + discount.Id)" data="@discount.Id" onclick="selectDiscount(this)"> Выбрать*@
                        </label>
                    </div>
                }
            </div>
        </div>
    </div>
    <input type="submit" value="Сформировать платеж" class="btn btn-default"/>
}
@section Scripts
{
    <script>
        var selectPlanId;
        var selectDiscountId;

        $(document).ready(function() {
            var discontCount = @Model.Discounts.Count();
            if (discontCount === 0) {
                $("#panelDiscounts").css("display", "none");
            }
        });

        function selectPlan(input) {
            selectPlanId = $(input).attr("data");
        }

        function selectDiscount(input) {
            selectDiscountId = $(input).attr("data");
        }

        function createPayment() {
            $.ajax({
                type: "POST",
                url: "@Url.Action("StartPay", "Payment")",
                data: {
                    selectPlanId: selectPlanId,
                    selectDiscountId: selectDiscountId
                }
            });
        }
    </script>
}
